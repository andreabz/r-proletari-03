---
title: "R per proletari"
logo: www/rproletari.png
subtitle: "Bollettino della qualità dell'aria per il glorioso popolo lavoratore"
params:
  build_timestamp: ""
---

```{r}
#| label: librerie

# carico le librerie necessarie per il progetto
library(here)
library(data.table)
library(httr2)
library(ggplot2)
library(quarto)
```

```{r}
#| label: script

source(here("R", "utils.R"))
source(here("R", "data_download.R"))
source(here("R", "data_anagrafiche.R"))
source(here("R", "analisi_numerica.R"))
source(here("R", "analisi_grafica.R"))
source(here("R", "report_helper.R"))
```

## Introduzione

Compagno, benvenuto! Questo sito dimostra come noi proletari della tastiera possiamo automatizzare la creazione e l'aggiornamento di report ripetitivi, liberandoci dal giogo di Excel e conquistando più tempo per studiare Il Capitale... o la Gazzetta dello sport.

Tutto il codice utilizzato è su [Github](https://github.com/andreabz/r-proletari-03), mentre su [LinkedIn](https://it.linkedin.com/in/andreabazzano/) trovi spiegazioni e commenti in puro stile maoista, per ogni porzione di codice.

## Mappa delle province

Clicca su una provincia per consultare il bollettino locale approvato dal GosAtmoNadzor - il Comitato Supremo per la Sorveglianza dell'Aria Popolare.

> Al popolo ossigeno, cloro al capitale!

```{=html}
  ```{r}
  #| label: mappa_svg
  #| output: asis
  here("www", "mappa.html") |> 
    readLines() |> 
    cat()
  ```
  <link rel="stylesheet" href="www/mappa.css" />
  <script src="www/mappa.js"></script>
```

## Come funziona

Ogni report è generato automaticamente alle 2:00 di notte, riportando i dati di due giorni prima, grazie alla collaborazione tra `R`, lo script `R/render_reports.R` e GitHub Actions.

Le fasi principali del processo sono:

- Scaricamento dei dati dalle API pubbliche dei compagni di [ARPA Emilia-Romagna](https://dati.arpae.it/api/3/action/datastore_search?resource_id=4dc855a1-6298-4b71-a1ae-d80693d43dcb&limit=5).
- Arricchimento dei dati con le anagrafiche delle stazioni di monitoraggio.
- Analisi e confronto con i limiti normativi del  
   [D.Lgs. 155/2010](https://www.normattiva.it/uri-res/N2Ls?urn:nir:stato:decreto.legislativo:2010-08-13;155).
- Produzione automatica dei report provinciali in formato HTML.
- Pubblicazione dei bollettini aggiornati su GitHub Pages.

::: {.callout-warning icon=false}

## Attenzione

Compagno, ricordati che questo progetto è solo dimostrativo.  
Se desideri consultare i dati ufficiali, rivolgiti ai [bollettini ufficiali di ARPA Emilia-Romagna](https://www.arpae.it/it/temi-ambientali/aria/dati-qualita-aria).  

L'obiettivo è mostrare la potenza di `R`, `Quarto` e dell'automazione open source!

:::


```{=html}
<p></p>

  ```{r}
  #| label: last_update
  #| output: asis
  
  # data dell'ultimo aggiornamento
  mostra_data_build(params$build_timestamp)
  ```
```


```{=html}
<footer class="copyright">
  &copy; 2025 Andrea Bazzano — <a href="https://www.linkedin.com/in/andreabazzano/" target="_blank">LinkedIn</a> | <a href="https://github.com/andreabz" target="_blank">GitHub</a> — Licenza CC-SA
</footer>
```
